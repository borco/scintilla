name: sync with official

on:
  schedule:
    - cron:  '15 4 * * *'
  push:
    branches:
      - 'mirror'
    paths:
      - '.github/workflows/sync.yml'
      - 'mirror.mk'

jobs:
  update-options:
    runs-on: ubuntu-latest      
    steps:    
        - name: Check out this repository
          run: |
            git clone --branch mirror https://github.com/missdeer/scintilla.git
          
        - name: Set up Git
          env:
            GITHUB_TOKEN: ${{ secrets.GH_TOKEN }}        
          run: |
            git config user.name "auto-update-lists[bot]"
            git config user.email "auto-update-lists[bot]@users.noreply.github.com"
    
        - name: sync with official
          run: |
            cd scintilla
            git remote set-url origin https://x-access-token:${GITHUB_TOKEN}@github.com/${GITHUB_REPOSITORY}.git
            git branch
            git remote -v
            ./mirror.mk
